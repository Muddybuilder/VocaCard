var _IE=0;var _active_language="";var _font_size=41;var _font_family="";var extName="";var _level=1;var _caps=0;var _shift_left=0;var _shift_right=0;var _alt_left=0;var _alt_right=0;var _ctrl_left=0;var _ctrl_right=0;var download_url="";var simulate_mouse_click=0;var ctrl_btn=0;var alt_btn=0;var shift_btn=0;var SHIFT_KEY=16;var CTRL_KEY=17;var ALT_KEY=18;var TAB_KEY=9;var ENTER_KEY=13;var BKSPACE_KEY=8;var CAPS_KEY=20;var DEL_KEY=46;var ESC_KEY=27;var SPACE=" ";var PGUP_KEY=33;var PGDN_KEY=34;var UP_KEY=38;var DN_KEY=40;var SPACE_KEY=32;var _activeWord=1;var _totalWords=3;var _autoComp=0;var exit=0;var _hide=1;var _kSemiColon=59;var _kEqual=107;var _kMinus=109;if($.browser.webkit){_kSemiColon=186;_kEqual=187;_kMinus=189}var alphanumeric_ids=[192,49,50,51,52,53,54,55,56,57,48,_kMinus,_kEqual,-1,-1,81,87,69,82,84,89,85,73,79,80,219,221,220,-1,65,83,68,70,71,72,74,75,76,_kSemiColon,222,-1,-1,90,88,67,86,66,78,77,188,190,191,-1,-1,-1,32,-1,-1];var s=new Array();s.A="\u0251";s["{"]="\u00E6";s["6"]="\u0250";s.Q="\u0252";s.E="\u025B";s["@"]="\u0259";s["3"]="\u025C";s.I="\u026A";s.O="\u0254";s["2"]="\u00F8";s["9"]="\u0153";s["&"]="\u0276";s.U="\u028A";s["}"]="\u0289";s.V="\u028C";s.Y="\u028F";s.B="\u03B2";s.C="\u0231";s.D="\u00F0";s.G="\u0263";s.L="\u028E";s.J="\u0272";s.N="\u014B";s.R="\u0281";s.S="\u0283";s.T="\u03B8";s.H="\u0265";s.Z="\u0292";s["?"]="\u0294";s[":"]="\u02D0";s['"']="\u02C8";s["%"]="\u02CC";var x=new Array();x.a=new Array("&#x0251;","&#x0252;","&#x0250;","&aelig;","&#x0276;","&alpha;");x.b=new Array("&#x0299;","&beta;","&#x0253;","&#x025E;");x.c=new Array("&#x0254;","&ccedil;","&#x0276;","&#x0255;","&#x010D;");x.d=new Array("&#x0256;","&#x0257;","&#x1E0D;","&#x00F0;","d&#x032A;");x.e=new Array("&#x0259;","&#x025A;","&#x0258;","&#x1EB9;","&#x025B;","&#x025C;","&epsilon;");x.f=new Array("&#x0278;","&#x0284;","&#x025F;");x.g=new Array("&#x0260;","&#x0261;","&#x0262;","&#x029B;","&gamma;","&#x0263;");x.h=new Array("&#x0127;","&#x0266;","&#x0265;","&#x029C;","&#x0267;","&#x1E27;","&#x02B0;");x.i=new Array("&#x026A;","&#x0268;","&#x026A;&#x0308;");x.j=new Array("&#x025F;","&#x029D;","&#x01F0;","&#x02B2;");x.l=new Array("&#x029F;","&#x026D;","&#x026E;","&#x026B;","&#x026C;");x.m=new Array("&#x0271;","&#x026F;","&#x0270;");x.n=new Array("&#x014B;","&#x0272;","&#x0273;","n&#x032A;");x.o=new Array("&#x0254;","&#x0153;","&#x0252;","&ouml;","&#x1ECD;");x.p=new Array("&#x0278;");x.r=new Array("&#x0279;","&#x0280;","&#x0281;","&#x027E;","&#x027D;");x.s=new Array("&#x0283;","&#x0282;","&#x0161;","&#x0284;","&#x015B;","&#x1E63;");x.t=new Array("&theta;","&#x00F0;","&#x0288;","&#x1E6D;","t&#x032A;");x.u=new Array("&#x028A;","&uuml;","&#x0289;");x.v=new Array("&#x028B;","&#x028C;");x.w=new Array("<sup>w</sup>","&#x0175;","&#x02B7;","&#x026F;","&#x0270;");x.x=new Array("&chi;");x.y=new Array("&#x028F;","&#x028E;","&#x0177;","&#x0263;","&#x0264;");x.z=new Array("&#x0292;","&#x0290;","&#x017E;","&#x01E93;","&#x0291;");x["0"]=new Array("&oslash;","&#x0298;","&#x0275;");x["1"]=new Array("|","&#x01C0;","&#x2016;","&#x01C1;","&#x01C2;");x["2"]=new Array("&#x0294;","&#x0295;","&#x02A1;","&#x02A2;");x["3"]=new Array("&#x025B;","&#x025C;","&#x0292;","&#x025D;","&#x025E;");x["="]=new Array("&#x2016;","&#x01C1;","&#x01C2;");x[":"]=new Array("&#x02D0;");x["'"]=new Array("&#x02D1;");x["/"]=new Array("&#x030B;","&#x0301;");x["\\"]=new Array("&#x030F;","&#x0300;");x._=new Array("&#x0325;","&#x032F;","&#x032C;","&#x0339;","&#x031C;","&#x031F;","&#x035C;");x["^"]=new Array("&#x030A;","&#x02DE;","&#x0303;","&#x0308;","&#x033D;","&#x0361;");x["?"]=x["2"];x["|"]=x["1"];function save_as(a){var b=download_url+"/"+a+"/"+Math.floor(Math.random()*100000);window.location=b}function init(a){check_IE_browser();$("#preview").css({"font-size":_font_size});load_keyboard(_active_language);updateCharCount();extName=a;$("#extName").val(extName)}function reset_ctrl_keys(){_shift_left=0;_shift_right=0;_alt_left=0;_alt_right=0;_ctrl_left=0;_ctrl_right=0}function reset_tabs(){$("ul.tabs li").removeClass("active");$("ul.tabs li").each(function(a){if($(this).text()=="Keyboard"){$(this).addClass("active");$(this).click()}})}function load_keyboard(b){var a="";if(b!=_active_language){}update_key_logic();_active_language=b;$("#preview").focus();switch(b){case"Smart IPA":a=Smart_IPA();break;case"Sampa English":a=Sampa_English();break;case"IPA English":a=IPA_English();break;case"Superscript":a=Superscript();break;case"Subscript":a=Subscript();break;case"Reversed":a=Reversed();break;case"LeftRight":a=LeftRight();break;case"Extended":a=Extended();break;case"Barred":a=Barred();break}$("#keyboard").html(a);update_highlight()}function update_key_logic(){var c=_alt_left||_alt_right;var b=_ctrl_left||_ctrl_right;var a=_shift_left||_shift_right;if((b&&c&&a)||(_alt_right&&a)){_level=4}else{if((b&&c)||_alt_right){_level=3}else{if(a){if(_caps){_level=1}else{_level=2}}else{if(_caps){_level=5}else{_level=1}}}}}function update_highlight(){if(_caps==1){$("#caps").css({background:"#0097DD"})}if(_shift_left==1){$("#shift_left").css({background:"#FE0E5D"})}if(_shift_right==1){$("#shift_right").css({background:"#FE0E5D"})}if(_alt_left==1){$("#alt_left").css({background:"#FE0E5D"})}if(_alt_right==1){$("#alt_right").css({background:"#FE0E5D"})}if(_ctrl_left==1){$("#ctrl_left").css({background:"#FE0E5D"})}if(_ctrl_right==1){$("#ctrl_right").css({background:"#FE0E5D"})}}function updateCharCount(){var a=$("#preview").val().length;$("#iChar").val(a);if(a>140){$("#iChar").css({color:"#FF0054"})}else{$("#iChar").css({color:"#444"})}}function check_IE_browser(){var a={Version:function(){var b=999;if(navigator.appVersion.indexOf("MSIE")!=-1){b=parseFloat(navigator.appVersion.split("MSIE")[1])}return b}};if(a.Version()<9){_IE=1}}function update_fonts(a){_font_family=a;$("#preview").css({"font-family":a})}function get_active_language(){var b=document.getElementById("ListBox_Languages");var a=b.selectedIndex;var c=b.options[a].value;return c}function get_next_pane(){var d=document.getElementById("ListBox_Types_fonts");var c=d.length;var b=d.selectedIndex;if(b<c-1){b+=1}else{b=0}d.selectedIndex=b;var a=d.options[b].value;update_fonts(a)}function get_back_pane(){var d=document.getElementById("ListBox_Types_fonts");var c=d.length;var b=d.selectedIndex;if(b>0){b-=1}else{b=c-1}d.selectedIndex=b;var a=d.options[b].value;update_fonts(a)}function get_next_keyboard(){var d=document.getElementById("ListBox_Languages");var c=d.length;var b=d.selectedIndex;if(b<c-1){b+=1}else{b=0}d.selectedIndex=b;var a=d.options[b].value;_active_language=a;load_keyboard(_active_language)}function get_back_keyboard(){var d=document.getElementById("ListBox_Languages");var c=d.length;var b=d.selectedIndex;if(b>0){b-=1}else{b=c-1}d.selectedIndex=b;var a=d.options[b].value;_active_language=a;load_keyboard(_active_language)}function hideBanner(){$("#iBanner").slideUp("slow");goPageTop();$("#hide_banner").text("Show Top Banner")}function goPageTop(){$("html, body").animate({scrollTop:0},500)}function updateUI(b,a){$("#"+b+" option:selected").removeAttr("selected");$("#"+b+" option[value="+a+"]").attr("selected","selected");load_keyboard(a)}function getCaretTopLeftPos(){var b=$("#preview").width();var k=$("#preview").height();var e=$("#preview").val();var q=document.getElementById("preview");var n=getCaret(q);var a=$("#divClonePreview");a.css({"font-family":_font_family});a.css({"font-size":_font_size});var d="_";var p=$("#spanClonePreview");p.css({"font-family":_font_family});p.css({"font-size":_font_size});p.html(d);var j=p.height();var m=p.width();var t="";for(var c=0;c<n;++c){if(e[c]=="\n"){t+="<br />"}else{if(e[c]==SPACE){t+="&nbsp"}else{t+=e[c]}}}a.html(t+"<span id='marker' style='position:absolute;'>"+d+"</span>");var g=$("#marker").position();var f=g.top+j;var o=f-q.scrollTop;var l=g.left-m;var r="";if(n>0){r=e[n-1]}return Array(o,l,r)}function inarray(a,b){for(i=0;i<a.length;i++){if(a[i]==b){return true}}return false}function recommend(){if($("#smart_check").is(":checked")&&(_active_language!="Sampa English")){_activeWord=1;_autoComp=1;var f=2*($("#autoComplete").outerWidth(true)-$("#autoComplete").width());var e,d,a;var c=getCaretTopLeftPos();d=c[0]-20;e=c[1]+f;a=c[2];if((a==SPACE)||(a=="")){$("#autoComplete").hide();_autoComp=0}else{if(a!="undefined"){var b=getContent(a.toLowerCase());if(b!=""){$("#autoComplete").html(b);$("#autoComplete").show();$("#autoComplete").css({position:"absolute",left:e+"px",top:d+"px"})}else{$("#autoComplete").hide();_autoComp=0}}}}}function getContent(c){var f;var d;var a=inComplexArray(c,x);var e="";if(a!=-1){_totalWords=x[a].length;for(var b=0;b<_totalWords;++b){f=b+1;if(b==0){d="selected"}else{d=""}if(c=="/"||c=="\\"||c=="_"||c=="^"){e+='<a class="choice silver tone '+d+'" style="padding:0 10px 0 25px;" id="'+f+'" href="#_">'+x[a][b]+"</a>"}else{e+='<a class="choice dfont '+d+'" id="'+f+'" href="#_">'+x[a][b]+"</a>"}}}return e}$("#backspace").live("click",function(){var a=document.getElementById("preview");var c=getCaret(a);var b=$("#preview").val();val=b.substring(0,c-1)+b.substring(c,b.length);$("#preview").val("");$("#preview").insertAtCaret(val);$("#preview").trigger("change");setCaretToPos(a,c-1)});$(".choice").live("click",function(){$("#"+_activeWord).removeClass("selected").addClass("deselected");var b=$(this).attr("id");_activeWord=b;$("#"+_activeWord).removeClass("deselected").addClass("selected");$("#backspace").click();var a=$(this).text();$("#preview").insertAtCaret(a);$("#autoComplete").hide();_autoComp=0});function resetChoices(){for(var a=1;a<=_totalWords;++a){$("#"+a).removeClass("selected").addClass("deselected")}}$(".choice").live("hover",function(){resetChoices();var b=$(this).attr("id");$("#"+b).removeClass("deselected").addClass("selected");var a=$(this).text()});$("#enter").live("click",function(){if(!_autoComp){a="\r";$("#preview").insertAtCaret(a);$("#preview").trigger("change")}else{$("#backspace").click();var a=$("#"+_activeWord).text();$("#preview").insertAtCaret(a);$("#autoComplete").hide();_autoComp=0}});function IE_keydown(b){if(_IE){var a=("which" in b)?b.which:b.keyCode;process_keydown(a,b)}}$("#preview").keydown(function(a){if(!_IE){key=(a.keyCode)?a.keyCode:a.which;process_keydown(key,a)}});function process_keydown(a,c){if(a==DN_KEY){if(_autoComp){i2preventDefault(c);$("#"+_activeWord).removeClass("selected").addClass("deselected");++_activeWord;if(_activeWord>_totalWords){_activeWord=1}$("#"+_activeWord).removeClass("deselected").addClass("selected")}}else{if(a==UP_KEY){if(_autoComp){i2preventDefault(c);$("#"+_activeWord).removeClass("selected").addClass("deselected");--_activeWord;if(_activeWord<1){_activeWord=_totalWords}$("#"+_activeWord).removeClass("deselected").addClass("selected")}}else{if(a==SHIFT_KEY){shift_btn=1}else{if(a==CTRL_KEY){ctrl_btn=1}else{if(a==ALT_KEY){alt_btn=1}}}$("."+a).addClass("shadow");$("."+a).addClass("cyan");if((a==SHIFT_KEY)||(a==CTRL_KEY)||(a==ALT_KEY)||(a==CAPS_KEY)||(a==TAB_KEY)){simulate_mouse_click=1;$("."+a).click();simulate_mouse_click=0}if(a==ENTER_KEY){if(_autoComp){i2preventDefault(c);simulate_mouse_click=1;$("."+a).click();simulate_mouse_click=0}}var b=inStringArray(a,alphanumeric_ids);if(((b>-1)&&(!ctrl_btn))||((b>-1)&&(ctrl_btn)&&(alt_btn))||((b>-1)&&(shift_btn)&&(alt_btn))||((b>-1)&&(alt_btn))||((b>-1)&&(ctrl_btn)&&(alt_btn)&&(shift_btn))){i2preventDefault(c);simulate_mouse_click=1;$("."+a).click();simulate_mouse_click=0}}}}function get_active_language(){var b=document.getElementById("ListBox_Languages");var a=b.selectedIndex;var c=b.options[a].value;return c}function IE_keyup(b){if(_IE){var a=("which" in b)?b.which:b.keyCode;process_keyup(a,b)}}$("#preview").keyup(function(a){if(!_IE){key=(a.keyCode)?a.keyCode:a.which;process_keyup(key,a)}});function process_keyup(a,c){if(a==ESC_KEY){$("#autoComplete").hide();_autoComp=0;return}if((a!=ENTER_KEY)&&(a!=SPACE_KEY)&&(a!=UP_KEY)&&(a!=DN_KEY)){recommend()}var b=inStringArray(a,alphanumeric_ids);if(b>-1){$("."+a).removeClass("shadow");$("."+a).removeClass("cyan")}if(a==SHIFT_KEY){shift_btn=0;_shift_left=0;_shift_right=0;load_keyboard(_active_language)}else{if(a==CTRL_KEY){ctrl_btn=0;_ctrl_left=0;_ctrl_right=0;load_keyboard(_active_language)}else{if(a==ALT_KEY){alt_btn=0;_alt_left=0;_alt_right=0;load_keyboard(_active_language)}}}if((a==TAB_KEY)||(a==ENTER_KEY)||(!_caps)||(a==BKSPACE_KEY)){$("#preview").focus();$("."+a).removeClass("shadow");$("."+a).removeClass("cyan")}}$("#tab").live("click",function(){val="\t";$("#preview").insertAtCaret(val);$("#preview").trigger("change")});$("#caps").live("click",function(){_caps=!_caps;load_keyboard(_active_language)});$("#shift_left").live("click",function(){if(simulate_mouse_click){_shift_left=1}else{_shift_left=!_shift_left;if(!_shift_left){ctrl_btn=0}}_shift_right=0;load_keyboard(_active_language)});$("#ctrl_left").live("click",function(){if(simulate_mouse_click){_ctrl_left=1}else{_ctrl_left=!_ctrl_left;if(!_ctrl_left){ctrl_btn=0}}_ctrl_right=0;load_keyboard(_active_language)});$("#shift_right").live("click",function(){if(simulate_mouse_click){_shift_right=1}else{_shift_right=!_shift_right;if(!_shift_right){ctrl_btn=0}}_shift_left=0;load_keyboard(_active_language)});$("#ctrl_right").live("click",function(){if(simulate_mouse_click){_ctrl_right=1}else{_ctrl_right=!_ctrl_right;if(!_ctrl_right){ctrl_btn=0}}_ctrl_left=0;load_keyboard(_active_language)});$("#alt_right").live("click",function(){if(simulate_mouse_click){_alt_right=1}else{_alt_right=!_alt_right;if(!_alt_right){alt_btn=0}}_alt_left=0;load_keyboard(_active_language)});$("#alt_left").live("click",function(){if(simulate_mouse_click){_alt_left=1}else{_alt_left=!_alt_left;if(!_alt_left){alt_btn=0}}_alt_right=0;load_keyboard(_active_language)});function i2sampa(b){var a=inComplexArray(b,s);if(a!=-1){b=s[a]}return b}$(".button.silver.key, .button.silver.keytone").live("click",function(){var a=$(this).val();if(a==SPACE){if(_autoComp){}else{}$("#autoComplete").hide();_autoComp=0}if(_active_language=="Sampa English"){a=i2sampa(a)}$("#preview").insertAtCaret(a);_editor=$("#preview").val();$("#preview").trigger("change");if(!simulate_mouse_click){recommend()}});function inComplexArray(c,b){for(var a in b){if(a==c){return a}}return -1}function getKey(d){var c=["192","49","50","51","52","53","54","55","56","57","48","189","187","8","9","81","87","69","82","84","89","85","73","79","80","219","221","220","20","65","83","68","70","71","72","74","75","76","186","222","13","16","90","88","67","86","66","78","77","188","190","191","1016","17","1018","32","18","1017"];for(var b=0;b<c.length;++b){var a=c[b];var e=$("."+a).val();if(escape(e)==d){return a}}return -1}function inStringArray(d,c){for(var a=0;a<c.length;++a){var b=new RegExp(c[a]);if(b.test(d)){return a}}return -1}$("#font_plus").live("click",function(){if(_font_size<=60){_font_size+=2;$("#preview").css({"font-size":_font_size})}});$("#font_minus").live("click",function(){if(_font_size>=13){_font_size-=2;$("#preview").css({"font-size":_font_size})}});$("#clear_btn").live("click",function(){_editor="";$("#preview").val("");updateCharCount()});function getCaret(c){if(c.selectionStart){return c.selectionStart}else{if(document.selection){c.focus();var d=document.selection.createRange();if(d==null){return 0}var b=c.createTextRange(),e=b.duplicate();b.moveToBookmark(d.getBookmark());e.setEndPoint("EndToStart",b);var f=0;for(var a=0;a<e.text.length;a++){if(e.text.substr(a,2)=="\r\n"){f+=2;a++}}return e.text.length+f}}return 0}function setSelectionRange(b,c,d){if(b.setSelectionRange){b.focus();b.setSelectionRange(c,d)}else{if(b.createTextRange){var a=b.createTextRange();a.collapse(true);a.moveEnd("character",d);a.moveStart("character",c);a.select()}}}function setCaretToPos(a,b){setSelectionRange(a,b,b)}function updateListBox(b,a){$("#"+b+" option:selected").removeAttr("selected");$("#"+b+" option[value="+a+"]").attr("selected","selected")}function i2preventDefault(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};